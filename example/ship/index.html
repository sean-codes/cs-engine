<!DOCTYPE html>
<html>

<head>
   <!-- View Setup -->
   <meta
      name="viewport"
      content="
         width=device-width,
         height=device-height,
         initial-scale=1.0,
         minimum-scale=1.0,
         maximum-scale=1.0,
         user-scalable=no,
         shrink-to-fit=no
      "
   >

   <!-- Game Engine -->
   <script src='../../engine/core.js'></script>

   <!-- helpers -->
   <link rel="stylesheet" href="../../engine/fullscreen.css"></link>
   <link rel="stylesheet" href="./style.css"></link>
</head>

<body style="background: #000">
   <!--Game Area-->
   <canvas class="cs-canvas" style="background:#999"></canvas>
   <!-- <div class="form-container">
      <div class="form">
         <label>Ship Name</label>
         <input id="username" type="text" maxlength="10"/>
         <button onclick="start()">start</button>
      </div>
   </div> -->

   <script>
      // function start() {
      //    var htmlFormContainer = document.querySelector('.form-container')
      //    var htmlName = document.querySelector('#username')
      //    var name = htmlName.value
      //
      //    if (name.length > 3 && name.length < 10) {
      //       cs.global.name = name
      //       htmlFormContainer.style.display = 'none'
      //    } else {
      //       htmlName.classList.add('error')
      //    }
      // }

      cs.load({
         parts: '../../engine',
         canvas: document.querySelector('canvas'),
         assets: {
            sprites: [
               { path: './sprites/ship' },
               { path: './sprites/background', fwidth: 48 },
               { path: './sprites/bullet' },
               { path: './sprites/burst' },
               { path: './sprites/icon_arrow' },
               { path: './sprites/icon_shoot' },
            ],
            scripts: [
               // objects
               { path: './objects/ship' },
               { path: './objects/background' },
               { path: './objects/bullet' },
               { path: './objects/gui' },
               { path: './objects/controller' },
               // scripts
               { path: './scripts/network' },
            ]
         },

         start: function() {
            cs.room.setup({
               width: 500,
               height: 500
            })

            cs.camera.setup({
               maxWidth: 300,
               maxHeight: 300,
               smoothing: 10
            })

            cs.surface.create({
               name: 'background',
               drawOutside: true,
               manualClear: true,
               oneToOne: false,
               useCamera: true,
               depth: 100
            })

            cs.global.name = 'test'
            cs.global.start = false

            cs.object.create({ type: 'background' })
            cs.object.create({ type: 'gui' })
            cs.object.create({ type: 'controller' })
            cs.camera.snap({ x: cs.room.width/2, y: cs.room.height/2 })
            
            // network overrides
            cs.network.setup({
               connect: cs.script.network.onConnect,
               disconnect: cs.script.network.onDisconnect,
               message: cs.script.network.onMessage,
            })
         },

         step: function() {
            if (!cs.global.start) {
               if (cs.global.name) {
                  cs.global.start = true

                  // connect
                  cs.network.connect({
                     host: '127.0.0.1',
                     port: 8080
                  })
               }
            }
         }
      })
   </script>
</body>

</html>
